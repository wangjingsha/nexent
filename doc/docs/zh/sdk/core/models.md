# Nexent æ¨¡å‹æ¨¡å—

æœ¬æ¨¡å—æä¾›äº†å¤šç§AIæ¨¡å‹æœåŠ¡ï¼ŒåŒ…æ‹¬è¯­éŸ³æœåŠ¡ã€åµŒå…¥æ¨¡å‹ã€å¤§è¯­è¨€æ¨¡å‹å’Œè§†è§‰è¯­è¨€æ¨¡å‹ã€‚æ¯ä¸ªæ¨¡å‹éƒ½éµå¾ªç»Ÿä¸€çš„æ¥å£è®¾è®¡ï¼Œæ”¯æŒé…ç½®ç®¡ç†å’Œé”™è¯¯å¤„ç†ã€‚

## ğŸ“‹ ç›®å½•

- [è¯­éŸ³æœåŠ¡ (STT & TTS)](#è¯­éŸ³æœåŠ¡-stt--tts)
- [åµŒå…¥æ¨¡å‹](#åµŒå…¥æ¨¡å‹)
- [å¤§è¯­è¨€æ¨¡å‹](#å¤§è¯­è¨€æ¨¡å‹)
- [è§†è§‰è¯­è¨€æ¨¡å‹](#è§†è§‰è¯­è¨€æ¨¡å‹)

## ğŸ¤ è¯­éŸ³æœåŠ¡ (STT & TTS)

æœ¬æ¨¡å—æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„è¯­éŸ³æœåŠ¡ï¼Œåœ¨å•ä¸ªç«¯å£ä¸ŠåŒæ—¶è¿è¡Œè¯­éŸ³è¯†åˆ«(STT)å’Œè¯­éŸ³åˆæˆ(TTS)æœåŠ¡ï¼Œä½¿ç”¨WebSocketè¿›è¡Œå®æ—¶é€šä¿¡ã€‚

### åŠŸèƒ½ç‰¹ç‚¹

- **è¯­éŸ³è¯†åˆ«(STT)**: é€šè¿‡WebSocketè¿æ¥è¿›è¡Œå®æ—¶éŸ³é¢‘è½¬å†™
- **è¯­éŸ³åˆæˆ(TTS)**: é€šè¿‡WebSocketæµå¼ä¼ è¾“å°†æ–‡æœ¬è½¬æ¢ä¸ºéŸ³é¢‘
- **å•ä¸€ç«¯å£**: ä¸¤ç§æœåŠ¡åœ¨åŒä¸€ç«¯å£ä¸Šè¿è¡Œï¼Œç®€åŒ–éƒ¨ç½²å’Œä½¿ç”¨
- **ä»…WebSocket**: ä¸¤ç§æœåŠ¡ä½¿ç”¨ä¸€è‡´çš„WebSocket APIæ¨¡å¼
- **æµå¼å¤„ç†**: æ”¯æŒå®æ—¶æµå¼éŸ³é¢‘è¯†åˆ«å’Œåˆæˆï¼Œæä¾›ä½å»¶è¿Ÿä½“éªŒ
- **é”™è¯¯å¤„ç†**: å®Œå–„çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€åé¦ˆæœºåˆ¶

### è®¾ç½®

1. åˆ›å»ºä¸€ä¸ªåŒ…å«APIå‡­è¯çš„`.env`æ–‡ä»¶:

```
# STTé…ç½®
APPID=your_stt_appid
TOKEN=your_token

# TTSé…ç½®
APPID=your_tts_appid
TOKEN=your_tts_token
CLUSTER=your_cluster
VOICE_TYPE=your_voice_type
```

### APIç«¯ç‚¹

#### è¯­éŸ³è¯†åˆ«(STT)

- WebSocket: `/stt/ws`
  - **è¯·æ±‚æ ¼å¼**: ä»¥äºŒè¿›åˆ¶å—æµå¼ä¼ è¾“PCMéŸ³é¢‘æ•°æ®
  - **éŸ³é¢‘è¦æ±‚**: 16kHzé‡‡æ ·ç‡, 16ä½æ·±åº¦, å•å£°é“, PCMåŸå§‹æ ¼å¼
  - **å“åº”æ ¼å¼**: å®æ—¶JSONè½¬å†™ç»“æœ
  - **å“åº”å­—æ®µ**:
    - `result` æˆ– `trans_result.text`: è¯†åˆ«çš„æ–‡æœ¬
    - `is_final`: æ˜¯å¦ä¸ºæœ€ç»ˆç»“æœ
    - `status`: æœåŠ¡çŠ¶æ€ä¿¡æ¯
    - `error`: å¦‚æœ‰é”™è¯¯ï¼ŒåŒ…å«é”™è¯¯ä¿¡æ¯

#### è¯­éŸ³åˆæˆ(TTS)

- WebSocket: `/tts/ws`
  - **è¯·æ±‚æ ¼å¼**: å‘é€JSONæ ¼å¼çš„æ–‡æœ¬: `{"text": "è¦åˆæˆçš„æ–‡æœ¬"}`
  - **å“åº”æ ¼å¼**: äºŒè¿›åˆ¶éŸ³é¢‘å— (é»˜è®¤ä¸ºMP3æ ¼å¼)
  - **å®Œæˆä¿¡å·**: æœ€ç»ˆæ¶ˆæ¯: `{"status": "completed"}`
  - **é”™è¯¯å“åº”**: `{"error": "é”™è¯¯ä¿¡æ¯"}`

## ğŸ”— åµŒå…¥æ¨¡å‹

åµŒå…¥æ¨¡å‹æä¾›äº†å°†æ–‡æœ¬ã€å›¾åƒç­‰å¤šç§æ•°æ®ç±»å‹è½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºçš„èƒ½åŠ›ï¼Œæ”¯æŒå¤šç§åç«¯æœåŠ¡ã€‚

### åŠŸèƒ½ç‰¹ç‚¹

-   **å¤šåç«¯æ”¯æŒ**: æ”¯æŒJinaå’ŒOpenAIç­‰å¤šç§åµŒå…¥æœåŠ¡ã€‚
-   **ç»Ÿä¸€æ–‡æœ¬æ¥å£**: æ‰€æœ‰æ¨¡å‹å‡æä¾›ç»Ÿä¸€çš„ `get_embeddings` æ–¹æ³•ï¼Œæ¥å—å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²åˆ—è¡¨ä½œä¸ºè¾“å…¥ï¼Œæ–¹ä¾¿å¤„ç†çº¯æ–‡æœ¬æ•°æ®ã€‚
-   **å¤šæ¨¡æ€èƒ½åŠ›**: åƒ `JinaEmbedding` è¿™æ ·çš„å¤šæ¨¡æ€æ¨¡å‹ï¼Œé¢å¤–æä¾›äº† `get_multimodal_embeddings` æ–¹æ³•ï¼Œå¯ä»¥å¤„ç†åŒ…å«æ–‡æœ¬å’Œå›¾åƒURLçš„å¤æ‚è¾“å…¥ã€‚
-   **é…ç½®çµæ´»**: æ”¯æŒé€šè¿‡å‚æ•°æˆ–ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ã€‚
-   **è¿æ¥æµ‹è¯•**: å†…ç½® `check_connectivity()` æ–¹æ³•ï¼Œç”¨äºéªŒè¯ä¸APIæœåŠ¡çš„è¿æ¥çŠ¶æ€ã€‚

### ä½¿ç”¨ç¤ºä¾‹

#### è·å–æ–‡æœ¬åµŒå…¥ (æ‰€æœ‰æ¨¡å‹é€šç”¨)

æ‰€æœ‰åµŒå…¥æ¨¡å‹éƒ½ä½¿ç”¨ `get_embeddings` æ–¹æ³•æ¥è·å–æ–‡æœ¬çš„åµŒå…¥å‘é‡ã€‚æ­¤æ–¹æ³•æ¥å—å•ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²åˆ—è¡¨ã€‚

```python
from nexent.core.models.embedding_model import JinaEmbedding, OpenAICompatibleEmbedding

# åˆå§‹åŒ–Jinaæ¨¡å‹ (åŒæ ·é€‚ç”¨äºOpenAICompatibleEmbedding)
embedding = JinaEmbedding(api_key="your_jina_api_key")

# è·å–å•ä¸ªæ–‡æœ¬çš„åµŒå…¥
text_input = "Hello, Nexent!"
embeddings = embedding.get_embeddings(text_input)
print(f"å•æ–‡æœ¬åµŒå…¥å‘é‡æ•°é‡: {len(embeddings)}")

# è·å–å¤šä¸ªæ–‡æœ¬çš„åµŒå…¥
text_list_input = ["è¿™æ˜¯ç¬¬ä¸€æ®µæ–‡æœ¬ã€‚", "è¿™æ˜¯ç¬¬äºŒæ®µæ–‡æœ¬ã€‚"]
embeddings_list = embedding.get_embeddings(text_list_input)
print(f"å¤šæ–‡æœ¬åµŒå…¥å‘é‡æ•°é‡: {len(embeddings_list)}")
```

#### è·å–å¤šæ¨¡æ€åµŒå…¥ (JinaEmbedding)

å¯¹äºæ”¯æŒå¤šæ¨¡æ€è¾“å…¥çš„æ¨¡å‹ï¼ˆå¦‚ `JinaEmbedding`ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ `get_multimodal_embeddings` æ–¹æ³•æ¥å¤„ç†åŒ…å«æ–‡æœ¬å’Œå›¾åƒçš„æ··åˆè¾“å…¥ã€‚

```python
from nexent.core.models.embedding_model import JinaEmbedding

# åˆå§‹åŒ–Jinaæ¨¡å‹
embedding = JinaEmbedding(api_key="your_jina_api_key")

# å®šä¹‰åŒ…å«æ–‡æœ¬å’Œå›¾åƒçš„å¤šæ¨¡æ€è¾“å…¥
multimodal_input = [
    {"text": "A beautiful sunset over the beach"},
    {"image": "https://example.com/sunset.jpg"}
]

# è·å–å¤šæ¨¡æ€åµŒå…¥
multimodal_embeddings = embedding.get_multimodal_embeddings(multimodal_input)
print(f"å¤šæ¨¡æ€åµŒå…¥å‘é‡æ•°é‡: {len(multimodal_embeddings)}")
```


## ğŸ¤– å¤§è¯­è¨€æ¨¡å‹

å¤§è¯­è¨€æ¨¡å‹æä¾›äº†æ–‡æœ¬ç”Ÿæˆå’Œå¯¹è¯èƒ½åŠ›ï¼ŒåŸºäºOpenAI APIå®ç°ã€‚

### åŠŸèƒ½ç‰¹ç‚¹

- **æµå¼è¾“å‡º**: æ”¯æŒå®æ—¶æµå¼æ–‡æœ¬ç”Ÿæˆ
- **æ¸©åº¦æ§åˆ¶**: å¯è°ƒèŠ‚ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§
- **ä¸Šä¸‹æ–‡ç®¡ç†**: æ”¯æŒå¤šè½®å¯¹è¯å’Œä¸Šä¸‹æ–‡ä¿æŒ
- **å·¥å…·è°ƒç”¨**: æ”¯æŒå‡½æ•°è°ƒç”¨å’Œå·¥å…·ä½¿ç”¨

### ä½¿ç”¨ç¤ºä¾‹

```python
from nexent.core.models.openai_llm import OpenAIModel
from nexent.core.utils.observer import MessageObserver

# åˆå§‹åŒ–æ¨¡å‹
observer = MessageObserver()
model = OpenAIModel(observer=observer, temperature=0.2, top_p=0.95)

# å‘é€æ¶ˆæ¯
messages = [{"role": "user", "content": "Hello"}]
response = model(messages=messages)
```

## ğŸ‘ï¸ è§†è§‰è¯­è¨€æ¨¡å‹

è§†è§‰è¯­è¨€æ¨¡å‹ç»“åˆäº†å›¾åƒç†è§£å’Œæ–‡æœ¬ç”Ÿæˆèƒ½åŠ›ï¼Œæ”¯æŒå›¾åƒæè¿°å’Œè§†è§‰é—®ç­”ã€‚

### åŠŸèƒ½ç‰¹ç‚¹

- **å›¾åƒå¤„ç†**: æ”¯æŒæœ¬åœ°å›¾åƒæ–‡ä»¶å’ŒURL
- **æµå¼è¾“å‡º**: æ”¯æŒå®æ—¶æµå¼æ–‡æœ¬ç”Ÿæˆ
- **æç¤ºè¯å®šåˆ¶**: å¯è‡ªå®šä¹‰ç³»ç»Ÿæç¤ºè¯
- **å¤šæ¨¡æ€ç†è§£**: ç»“åˆè§†è§‰å’Œè¯­è¨€ç†è§£èƒ½åŠ›

### ä½¿ç”¨ç¤ºä¾‹

```python
from nexent.core.models.openai_vlm import OpenAIVLModel
from nexent.core.utils.observer import MessageObserver

# åˆå§‹åŒ–æ¨¡å‹
observer = MessageObserver()
model = OpenAIVLModel(observer=observer)

# åˆ†æå›¾åƒ
image_path = "path/to/image.jpg"
result = model.analyze_image(image_path, system_prompt="è¯·æè¿°è¿™å¼ å›¾ç‰‡")
```

## ğŸ”§ é€šç”¨ç‰¹æ€§

æ‰€æœ‰æ¨¡å‹éƒ½æ”¯æŒä»¥ä¸‹é€šç”¨ç‰¹æ€§ï¼š

### é”™è¯¯å¤„ç†

- è¿æ¥é”™è¯¯æ•è·å’Œå¤„ç†
- æœåŠ¡çŠ¶æ€ç›‘æ§å’Œåé¦ˆ
- å®¢æˆ·ç«¯å‹å¥½çš„é”™è¯¯æ¶ˆæ¯

### é…ç½®ç®¡ç†

- ç¯å¢ƒå˜é‡é…ç½®
- .envæ–‡ä»¶æ”¯æŒ
- è¿è¡Œæ—¶é…ç½®è¦†ç›–

### è¿æ¥æµ‹è¯•

æ‰€æœ‰æ¨¡å‹éƒ½å®ç°äº†`check_connectivity()`æ–¹æ³•ï¼Œç”¨äºæµ‹è¯•ä¸è¿œç¨‹æœåŠ¡çš„è¿æ¥çŠ¶æ€ï¼š

```python
# æµ‹è¯•è¿æ¥
if model.check_connectivity():
    print("æœåŠ¡è¿æ¥æ­£å¸¸")
else:
    print("æœåŠ¡è¿æ¥å¤±è´¥")
``` 